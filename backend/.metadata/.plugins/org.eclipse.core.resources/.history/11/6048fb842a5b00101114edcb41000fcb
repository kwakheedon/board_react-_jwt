package com.example.board.domain.member;

import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Service;

import com.example.board.domain.member.dto.SignUpReq;
import com.example.board.exception.CustomException;
import com.example.board.exception.ErrorCode;

import jakarta.transaction.Transactional;
import lombok.RequiredArgsConstructor;

@Service
@RequiredArgsConstructor
public class MemberService {
	private final MemberRepository memberRepository;
	private final PasswordEncoder passwordEncoder;

	@Transactional
	public void signup(SignUpReq request) {
		if (memberRepository.existsByEmail(request.getEmail())) {
			throw new CustomException(ErrorCode.USER_ALREADY_EXISTS, "ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì´ë©”ì¼ì…ë‹ˆë‹¤.");
		}
		String encryptedPassword = passwordEncoder.encode(request.getPassword());

		Member member = Member.builder().email(request.getEmail()).password(encryptedPassword) // ğŸ‘ˆ ì•”í˜¸í™”ëœ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì €ì¥
				.nickname(request.getNickname()).role(Role.USER).build();

		memberRepository.save(member);

	}
}